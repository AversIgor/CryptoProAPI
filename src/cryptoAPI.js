(function e(t,C,_){function r(E,A){if(!C[E]){if(!t[E]){var O=typeof require=="function"&&require;if(!A&&O)return O(E,!0);if(n)return n(E,!0);var I=new Error("Cannot find module '"+E+"'");throw I.code="MODULE_NOT_FOUND",I}var i=C[E]={exports:{}};t[E][0].call(i.exports,function(e){var C=t[E][1][e];return r(C?C:e)},i,i.exports,e,t,C,_)}return C[E].exports}var n=typeof require=="function"&&require;for(var E=0;E<_.length;E++)r(_[E]);return r})({1:[function(e,t,C){var _={};_.StoreLocation={CAPICOM_MEMORY_STORE:0,CAPICOM_LOCAL_MACHINE_STORE:1,CAPICOM_CURRENT_USER_STORE:2,CAPICOM_ACTIVE_DIRECTORY_USER_STORE:3,CAPICOM_SMART_CARD_USER_STORE:4};_.StoreOpenMode={CAPICOM_STORE_OPEN_READ_ONLY:0,CAPICOM_STORE_OPEN_READ_WRITE:1,CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED:2,CAPICOM_STORE_OPEN_EXISTING_ONLY:128,CAPICOM_STORE_OPEN_INCLUDE_ARCHIVED:256};_.CertFindType={CAPICOM_CERTIFICATE_FIND_SHA1_HASH:0,CAPICOM_CERTIFICATE_FIND_SUBJECT_NAME:1,CAPICOM_CERTIFICATE_FIND_ISSUER_NAME:2,CAPICOM_CERTIFICATE_FIND_ROOT_NAME:3,CAPICOM_CERTIFICATE_FIND_TEMPLATE_NAME:4,CAPICOM_CERTIFICATE_FIND_EXTENSION:5,CAPICOM_CERTIFICATE_FIND_EXTENDED_PROPERTY:6,CAPICOM_CERTIFICATE_FIND_APPLICATION_POLICY:7,CAPICOM_CERTIFICATE_FIND_CERTIFICATE_POLICY:8,CAPICOM_CERTIFICATE_FIND_TIME_VALID:9,CAPICOM_CERTIFICATE_FIND_TIME_NOT_YET_VALID:10,CAPICOM_CERTIFICATE_FIND_TIME_EXPIRED:11,CAPICOM_CERTIFICATE_FIND_KEY_USAGE:12};_.Time={AUTHENTICATED_ATTRIBUTE_SIGNING_TIME:0};_.Check={CHECK_NONE:0,CHECK_TRUSTED_ROOT:1,CHECK_TIME_VALIDITY:2,CHECK_SIGNATURE_VALIDITY:4,CHECK_ONLINE_REVOCATION_STATUS:8,CHECK_OFFLINE_REVOCATION_STATUS:16,TRUST_IS_NOT_TIME_VALID:1,TRUST_IS_NOT_TIME_NESTED:2,TRUST_IS_REVOKED:4,TRUST_IS_NOT_SIGNATURE_VALID:8,TRUST_IS_NOT_VALID_FOR_USAGE:16,TRUST_IS_UNTRUSTED_ROOT:32,TRUST_REVOCATION_STATUS_UNKNOWN:64,TRUST_IS_CYCLIC:128,TRUST_IS_PARTIAL_CHAIN:65536,TRUST_CTL_IS_NOT_TIME_VALID:131072,TRUST_CTL_IS_NOT_SIGNATURE_VALID:262144,TRUST_CTL_IS_NOT_VALID_FOR_USAGE:524288};_.PropId={CAPICOM_PROPID_UNKNOWN:0,CAPICOM_PROPID_KEY_PROV_HANDLE:1,CAPICOM_PROPID_KEY_PROV_INFO:2,CAPICOM_PROPID_SHA1_HASH:3,CAPICOM_PROPID_HASH_PROP:3,CAPICOM_PROPID_MD5_HASH:4,CAPICOM_PROPID_KEY_CONTEXT:5,CAPICOM_PROPID_KEY_SPEC:6,CAPICOM_PROPID_IE30_RESERVED:7,CAPICOM_PROPID_PUBKEY_HASH_RESERVED:8,CAPICOM_PROPID_ENHKEY_USAGE:9,CAPICOM_PROPID_CTL_USAGE:9,CAPICOM_PROPID_NEXT_UPDATE_LOCATION:10,CAPICOM_PROPID_FRIENDLY_NAME:11,CAPICOM_PROPID_PVK_FILE:12,CAPICOM_PROPID_DESCRIPTION:13,CAPICOM_PROPID_ACCESS_STATE:14,CAPICOM_PROPID_SIGNATURE_HASH:15,CAPICOM_PROPID_SMART_CARD_DATA:16,CAPICOM_PROPID_EFS:17,CAPICOM_PROPID_FORTEZZA_DATA:18,CAPICOM_PROPID_ARCHIVED:19,CAPICOM_PROPID_KEY_IDENTIFIER:20,CAPICOM_PROPID_AUTO_ENROLL:21,CAPICOM_PROPID_PUBKEY_ALG_PARA:22,CAPICOM_PROPID_CROSS_CERT_DIST_POINTS:23,CAPICOM_PROPID_ISSUER_PUBLIC_KEY_MD5_HASH:24,CAPICOM_PROPID_SUBJECT_PUBLIC_KEY_MD5_HASH:25,CAPICOM_PROPID_ENROLLMENT:26,CAPICOM_PROPID_DATE_STAMP:27,CAPICOM_PROPID_ISSUER_SERIAL_NUMBER_MD5_HASH:28,CAPICOM_PROPID_SUBJECT_NAME_MD5_HASH:29,CAPICOM_PROPID_EXTENDED_ERROR_INFO:30,CAPICOM_PROPID_RENEWAL:64,CAPICOM_PROPID_ARCHIVED_KEY_HASH:65,CAPICOM_PROPID_FIRST_RESERVED:66,CAPICOM_PROPID_LAST_RESERVED:32767,CAPICOM_PROPID_FIRST_USER:32768,CAPICOM_PROPID_LAST_USER:65535};_.SignatureType={CADESCOM_XML_SIGNATURE_TYPE_ENVELOPED:0,CADESCOM_XML_SIGNATURE_TYPE_ENVELOPING:1,CADESCOM_XML_SIGNATURE_TYPE_TEMPLATE:2};_.HashAlgorithm={CADESCOM_HASH_ALGORITHM_CP_GOST_3411:100,CADESCOM_HASH_ALGORITHM_MD2:1,CADESCOM_HASH_ALGORITHM_MD4:2,CADESCOM_HASH_ALGORITHM_MD5:3,CADESCOM_HASH_ALGORITHM_SHA_256:4,CADESCOM_HASH_ALGORITHM_SHA_384:5,CADESCOM_HASH_ALGORITHM_SHA_512:6,CADESCOM_HASH_ALGORITHM_SHA1:0};_.CadesType={CADESCOM_CADES_DEFAULT:0,CADESCOM_CADES_BES:1,CADESCOM_CADES_X_LONG_TYPE_1:93};_.ContentEncoding={CADESCOM_BASE64_TO_BINARY:1,CADESCOM_STRING_TO_UCS2LE:0};_.StoreNames={CAPICOM_MY_STORE:"My"};_.Chain={CAPICOM_CERTIFICATE_INCLUDE_CHAIN_EXCEPT_ROOT:0,CAPICOM_CERTIFICATE_INCLUDE_WHOLE_CHAIN:1,CAPICOM_CERTIFICATE_INCLUDE_END_ENTITY_ONLY:2};_.GostXmlDSigUrls={XmlDsigGost3410Url:"urn:ietf:params:xml:ns:cpxmlsec:algorithms:gostr34102001-gostr3411",XmlDsigGost3411Url:"urn:ietf:params:xml:ns:cpxmlsec:algorithms:gostr3411",XmlDsigGost3410UrlObsolete:"http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411",XmlDsigGost3411UrlObsolete:"http://www.w3.org/2001/04/xmldsig-more#gostr3411"};if(typeof define==="function"&&typeof define.amd!=="undefined"){define("CryptoConstant",_)}if(typeof t!=="undefined"&&typeof t.exports!=="undefined"){t.exports=_}else{window.CryptoConstant=_}},{}],2:[function(e,t,C){var _={noCertificate:"В хранилище нет ни одного сертификата",noHashCertificate:"Не удалось найти сертификат в хранилище по Hash",noCertificatesStore:"В хранилище не найдено ни одного сертификата",cantCreateSignature:"Не получилось создать подпись в формате Pkcs7 из за ошибки:",cantCreateSignatureXML:"Не получилось создать подпись в формате XML из за ошибки:",cantCreateSignatureHash:"Не получилось создать подпись Hash значения из за ошибки:",noPlugin:"Не установлен браузер плагин или Крипто Про CSP",verifyPkcs7:"Верификация подписи формата Pkcs7 не прошла из-из ошибки",verifyXML:"Верификация подписи формата XML не прошла из-из ошибки",verifyHash:"Верификация подписи Hash не прошла из-из ошибки:"};if(typeof define==="function"&&typeof define.amd!=="undefined"){define("CryptoMessage",_)}if(typeof t!=="undefined"&&typeof t.exports!=="undefined"){t.exports=_}else{window.CryptoMessage=_}},{}],3:[function(e,t,C){var _=e("./CryptoConstant");var r=e("./CryptoMessage");(function(e,t,C){"use strict";if(Object.keys(e).length){return}function _(e){var t=e.message;if(!t){t=e}else if(e.number){t+=" ("+e.number+")"}console.log(t)}var r=false,n;n={isIE:navigator.userAgent.match(/msie/i)||navigator.userAgent.match(/Trident\/./i),init:function(){var e=document.createElement("object");e.id="cadesplugin";e.type="application/x-cades";e.className="hiddenObject";document.body.appendChild(e);if(!this.checkPlugin()){_(C.noPlugin)}},checkPlugin:function(){try{var e=this.createObject("CAdESCOM.About");r=true;return e}catch(t){}return false},createObject:function(e){if(!this.isIE){var t=document.getElementById("cadesplugin");return t.CreateObject(e)}return new ActiveXObject(e)},convertDate:function(e){if(!this.isIE){return e}return e.getVarDate()},reverse:function(e){var t="",C;for(C=e.length-1;C>=0;C--){t+=e.charAt(C)}return t},base64Encode:function(e){e=JSON.stringify(e);e=unescape(encodeURIComponent(e));var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var C="",_=0,r=e.length,n,E,A;while(_<r){n=e.charCodeAt(_++)&255;if(_==r){C+=t.charAt(n>>2);C+=t.charAt((n&3)<<4);C+="==";break}E=e.charCodeAt(_++);if(_==r){C+=t.charAt(n>>2);C+=t.charAt((n&3)<<4|(E&240)>>4);C+=t.charAt((E&15)<<2);C+="=";break}A=e.charCodeAt(_++);C+=t.charAt(n>>2);C+=t.charAt((n&3)<<4|(E&240)>>4);C+=t.charAt((E&15)<<2|(A&192)>>6);C+=t.charAt(A&63)}return C},isArray:function(e){return Object.prototype.toString.call(e)==="[object Array]"}};n.init();e.getByHash=function(E){if(!(this instanceof e.getByHash)){return new e.getByHash(E)}var A,O;if(!r)return;try{A=n.createObject("CAPICOM.store");A.Open(t.StoreLocation.CAPICOM_CURRENT_USER_STORE,t.StoreNames.CAPICOM_MY_STORE,t.StoreOpenMode.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED);O=A.Certificates;if(O.Count===0){_(C.noCertificate)}else{O=O.Find(t.CertFindType.CAPICOM_CERTIFICATE_FIND_SHA1_HASH,E);if(O.Count>0)this.cetificate=O.Item(1);else _(C.noHashCertificate)}A.Close();A=O=null}catch(I){if(I.number!==-2138568446)_("Ошибка при получении сертификата: "+I);this.cetificate=null}};e.getByHash.prototype={get:function(){return this.cetificate},getExtendedKeyUsage:function(){var e=this.cetificate,t=e.ExtendedKeyUsage().EKUs.Count,C=[];if(t>0){while(t>0){C.push(e.ExtendedKeyUsage().EKUs.Item(t).OID);t--}}return C},hasKeyUsageOID:function(e){if(n.isArray(e)){var t=this.getExtendedKeyUsage();var C={},_=e.length-1;while(_>-1){C[e[_]]=!!~t.indexOf(e[_]);_--}return C}else{return!!~this.getExtendedKeyUsage().indexOf(e)}},isKeyValid:function(){return!!this.cetificate.IsValid().Result},getOwner:function(){var e=this.cetificate.SubjectName.split(", "),t={"CN=":"Владелец","S=":"Регион/Город","STREET=":"Адрес","O=":"Компания","OU=":"Тип должности","T=":"Должность","ОГРН=":"ОГРН","СНИЛС=":"СНИЛС","ИНН=":"ИНН","E=":"Email","L=":"Город"};e=e.map(function(e){var C=e.substring(0,e.indexOf("=")+1);if(t[C])return e.replace(C,t[C]+": ")}).filter(function(e){return!!e});return e.join("\n")},getIssuer:function(){var e=this.cetificate.SubjectName.split(", "),t={"CN=":"Удостоверяющий центр","S=":"Регион/Город","STREET=":"Адрес","O=":"Компания","OU=":"Тип","T=":"Должность","ОГРН=":"ОГРН","СНИЛС=":"СНИЛС","ИНН=":"ИНН","E=":"Email","L=":"Город"};e=e.map(function(e){var C=e.substring(0,e.indexOf("=")+1);if(t[C])return e.replace(C,t[C]+": ")}).filter(function(e){return!!e});return e.join("\n")},getAlgorithm:function(){return{Algorithm:this.cetificate.PublicKey().Algorithm.FriendlyName,OID:this.cetificate.PublicKey().Algorithm.Value}}};e.getList=function(){var e,E;if(!r)return;try{e=n.createObject("CAPICOM.store");e.Open(t.StoreLocation.CAPICOM_CURRENT_USER_STORE,t.StoreNames.CAPICOM_MY_STORE,t.StoreOpenMode.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED);E=e.Certificates;if(E.Count===0){_(C.noCertificate)}else{var A,O=[],I;E=E.Find(t.CertFindType.CAPICOM_CERTIFICATE_FIND_EXTENDED_PROPERTY,t.PropId.CAPICOM_PROPID_KEY_PROV_INFO).Find(t.CertFindType.CAPICOM_CERTIFICATE_FIND_TIME_VALID);I=E.Count;if(I>0){while(I>0){A=E.Item(I);O.push({thumbprint:A.Thumbprint,inform:A.GetInfo(0),validTo:A.ValidToDate,validFrom:A.ValidFromDate});I--}}else{_(C.noCertificatesStore)}}e.Close();e=E=null}catch(i){if(i.number!==-2138568446)_("Ошибка при получении сертификата: "+i);return}return O};e.SignPkcs7=function(e,r,E){var A,O,I,i=new Date,a=!!E;A=n.createObject("CAdESCOM.CPSigner");O=n.createObject("CAdESCOM.CadesSignedData");I=n.createObject("CADESCOM.CPAttribute");I.Name=t.Time.AUTHENTICATED_ATTRIBUTE_SIGNING_TIME;I.Value=n.convertDate(i);A.Certificate=this.getByHash(e).get();A.AuthenticatedAttributes2.Add(I);A.Options=t.Chain.CAPICOM_CERTIFICATE_INCLUDE_WHOLE_CHAIN;O.ContentEncoding=t.ContentEncoding.CADESCOM_BASE64_TO_BINARY;O.Content=n.base64Encode(r);try{var S=O.SignCades(A,t.CadesType.CADESCOM_CADES_BES,a)}catch(T){_(C.cantCreateSignature+" "+T);return}A=O=I=null;return S};e.SignXML=function(e,r){var E,A;E=n.createObject("CAdESCOM.CPSigner");A=n.createObject("CAdESCOM.SignedXML");E.Certificate=this.getByHash(e).get();A.Content=r;A.SignatureType=t.SignatureType.CADESCOM_XML_SIGNATURE_TYPE_ENVELOPED;A.SignatureMethod=t.GostXmlDSigUrls.XmlDsigGost3410Url;A.DigestMethod=t.GostXmlDSigUrls.XmlDsigGost3411Url;try{var O=A.Sign(E)}catch(I){_(C.cantCreateSignatureXML+" "+I);return}E=A=null;return O};e.getHash=function(e,C){var _,r;_=n.createObject("CAdESCOM.HashedData");_.Algorithm=t.HashAlgorithm.CADESCOM_HASH_ALGORITHM_CP_GOST_3411;if(C!==undefined&&C===true){_.DataEncoding=t.ContentEncoding.CADESCOM_BASE64_TO_BINARY;e=n.base64Encode(e)}_.Hash(e);r=_.Value;_=null;return r};e.SignHash=function(e,r,E){var A,O,I;if(E===true){var i=n.createObject("CAdESCOM.CPSigner");O=n.createObject("CAdESCOM.CadesSignedData");i.Certificate=this.getByHash(e).get()}else{O=n.createObject("CAdESCOM.RawSignature");var a=this.getByHash(e).get()}A=n.createObject("CAdESCOM.HashedData");A.Algorithm=t.HashAlgorithm.CADESCOM_HASH_ALGORITHM_CP_GOST_3411;A.SetHashValue(r);try{if(E===true)I=O.SignHash(A,i,t.ContentEncoding.CADESCOM_BASE64_TO_BINARY);else I=O.SignHash(A,a)}catch(S){_(C.cantCreateSignatureHash+" "+S);return}A=O=null;return I};e.VerifyHash=function(e,r,E,A){var O,I,i;O=n.createObject("CAdESCOM.HashedData");i=this.getByHash(e).get();if(A===true)I=n.createObject("CAdESCOM.CadesSignedData");else I=n.createObject("CAdESCOM.RawSignature");O.Algorithm=t.HashAlgorithm.CADESCOM_HASH_ALGORITHM_CP_GOST_3411;O.SetHashValue(r);try{if(A===true)I.VerifyHash(O,E,t.ContentEncoding.CADESCOM_BASE64_TO_BINARY);else I.VerifyHash(O,i,E)}catch(a){_(C.verifyHash+" "+a);return}return true};e.VerifyPkcs7=function(e,r){var E,A=!!r;E=n.createObject("CAdESCOM.CadesSignedData");try{E.VerifyCades(e,t.CadesType.CADESCOM_CADES_BES,A)}catch(O){_(C.verifyPkcs7+" "+O);return}E=null;return true};e.VerifyXML=function(e){var t=n.createObject("CAdESCOM.SignedXML");try{t.Verify(e)}catch(r){_(C.verifyXML+" "+r);return}t=null;return true};window.CryptoPro=e})(window["CryptoPro"]||{},_,r)},{"./CryptoConstant":1,"./CryptoMessage":2}]},{},[3]);